*** Begin Patch
*** Add File: docs/hardening/audit-hardening-v2.md
+# Audit Hardening v2
+
+This document outlines the second iteration of audit hardening across the multi‑agent system.  It describes the scope model, failure categories, guardrails user experience (UX), schema versioning strategy, A08 recovery procedures, and CI/CD rollback considerations.
+
+## Scope model
+
+Define least‑privilege scopes for each agent or workflow.  Scopes should follow the principle of least privilege: only the minimum permissions required to perform a task.  Document how scopes are granted and revoked.
+
+## Failure taxonomy
+
+Categorize failures into classes (transient, persistent, external dependency, etc.) and describe appropriate retry and escalation strategies for each class.  Include examples.
+
+## Guardrails UX
+
+Explain how guardrail failures should be surfaced to users and operators, including messages, logs, and actionable instructions.  Provide a user‑friendly explanation for each guardrail scenario.
+
+## Schema versioning
+
+All runbook files must include a `schemaVersion` field.  Document the versioning policy and how backwards compatibility is maintained when the schema evolves.
+
+## A08 health & recovery agent
+
+Describe recovery phases for the A08 agent, including dead‑letter sweep, stuck workflow detection, replay attempts, and operator notifications.  Provide thresholds and alerting guidance.
+
+## CI/CD rollback
+
+Outline rollback mechanisms in CI/CD pipelines.  Include sample templates for Azure DevOps and GitHub Actions to revert deployments safely.
*** Add File: docs/hardening/scope-model.md
+# Scope Model
+
+The scope model defines the permissions available to each agent or workflow in the enterprise multi‑agent system.  Each scope represents a collection of capabilities that can be granted to a runbook step or to an agent.
+
+## Principles
+
+- **Least privilege:** grant only the permissions necessary to perform the task.
+- **Separation of duties:** avoid combining high‑impact operations in a single scope.
+- **Auditable grants:** record when scopes are granted and revoked.
+
+## Implementation
+
+Scopes are defined in the runbook schema.  Each step declares the scopes it requires.  The orchestrator checks that the scopes are available before executing the step.  When scopes change, an audit log entry should capture the reason and the requesting operator.
*** Add File: docs/hardening/failure-taxonomy.md
+# Failure Taxonomy
+
+This document categorizes failures and describes the appropriate handling strategy for each.
+
+## Transient failures
+
+Transient failures are temporary errors caused by network issues, rate limits, or other recoverable conditions.  Recommended action: retry with exponential backoff.
+
+## Persistent failures
+
+Persistent failures occur when the operation cannot succeed without external intervention (e.g., invalid parameters, missing resources).  Recommended action: log the error and alert the operator; do not retry automatically.
+
+## External dependency failures
+
+Failures triggered by dependencies outside of the system's control (e.g., cloud service outage).  Recommended action: enter a backoff period, monitor the external service, and retry when the service is healthy.  Provide clear status to the operator.
+
+## Idempotency
+
+Ensure that retries are safe: operations should be idempotent whenever possible.  If not, implement compensation logic to handle duplicate execution.
*** Add File: docs/hardening/guardrails-ux.md
+# Guardrails UX
+
+Guardrails protect the system and its operators from unintended consequences.  When a guardrail triggers, the user experience should be clear and actionable.
+
+## User messaging
+
+- Present a concise explanation of why the action was blocked.
+- Suggest how the user can resolve the issue, such as requesting additional scopes or adjusting parameters.
+- Provide a reference to documentation or runbook.
+
+## Logging
+
+- Include guardrail identifiers and trigger conditions in system logs.
+- Correlate guardrail events with runbook and step identifiers to aid troubleshooting.
+
+## Operator workflow
+
+Operators should be able to acknowledge guardrail events, override when appropriate, and document their decision.  The system should track these overrides for audit purposes.
*** Add File: docs/hardening/schema-versioning.md
+# Schema Versioning
+
+Runbook files include a `schemaVersion` field to indicate which schema they conform to.  Versioning ensures that new features can be added without breaking existing runbooks.
+
+## Policy
+
+- Versions follow semantic versioning (`major.minor.patch`).
+- Backwards‑compatible changes increment the minor version.
+- Breaking changes increment the major version and may require a migration script.
+
+## Runbook requirements
+
+All runbooks must specify a `schemaVersion`.  The orchestrator validates the runbook against the corresponding JSON schema.
+
+## Migration
+
+When a schema changes, provide a migration guide.  Tools like `scripts/validate_runbook.py` can aid in detecting outdated runbooks and guiding updates.
*** Add File: docs/hardening/a08-recovery-runbook.md
+# A08 Recovery Runbook
+
+This document describes the health and recovery procedures for the A08 agent responsible for orchestrating stuck or failed workflows.
+
+## Overview
+
+The recovery agent monitors in‑progress workflows and attempts to heal them automatically.  It performs the following phases:
+
+1. **Dead‑letter sweep:** Scan for messages and tasks that have failed and moved to a dead‑letter queue.  Attempt a controlled replay if the cause is transient.
+2. **Stuck workflow detection:** Identify workflows that have not made progress for a configurable period.  Inspect the current step and decide whether to retry or alert an operator.
+3. **Replay attempts:** Retry steps that may succeed upon re‑execution.  Ensure that the operations are idempotent or compensate for duplicates.
+4. **Operator notification:** When automatic recovery fails, notify an operator with details and suggested actions.
+
+## Safety guidelines
+
+- Limit the number of automatic retries to avoid runaway loops.
+- Include correlation identifiers in alerts so operators can trace the issue quickly.
+- Document any manual actions taken during recovery for future audits.
*** Add File: docs/hardening/ci-cd-rollback.md
+# CI/CD Rollback Strategies
+
+To ensure safe deployments, define rollback procedures in your CI/CD pipelines.  A rollback can be triggered manually or automatically when a deployment fails.
+
+## Azure DevOps
+
+Example stage template:
+
+```yaml
+# ci/azure-devops/rollback-template.yml
+parameters:
+  environment: 'production'
+  rollback_steps:
+    - script: echo "Rolling back deployment"
+stages:
+  - stage: Rollback
+    jobs:
+      - job: Rollback
+        steps: ${{ parameters.rollback_steps }}
+```
+
+## GitHub Actions
+
+Example workflow:
+
+```yaml
+# .github/workflows/rollback-example.yml
+name: Rollback
+on:
+  workflow_dispatch:
+    inputs:
+      environment:
+        description: 'Environment to roll back'
+        required: true
+        default: 'production'
+jobs:
+  rollback:
+    runs-on: ubuntu-latest
+    steps:
+      - name: Rollback
+        run: echo "Rolling back ${{ github.event.inputs.environment }}"
+```
+
+## Best practices
+
+- Test rollback regularly as part of the pipeline.
+- Use immutable artifacts so that the rollback action can quickly deploy the previous version.
+- Record every rollback event in the audit log with the reason and initiator.
*** Add File: schemas/emu-runbook.schema.json
+{
+  "$schema": "http://json-schema.org/draft-07/schema#",
+  "title": "EMU Runbook",
+  "type": "object",
+  "required": ["schemaVersion", "runbookId", "scopes", "steps"],
+  "properties": {
+    "schemaVersion": {
+      "type": "string",
+      "description": "Schema version of the runbook"
+    },
+    "runbookId": {
+      "type": "string",
+      "description": "Unique identifier for the runbook"
+    },
+    "scopes": {
+      "type": "array",
+      "items": {
+        "type": "string"
+      },
+      "description": "List of scopes required by this runbook"
+    },
+    "failurePolicy": {
+      "type": "string",
+      "description": "Failure handling policy (e.g., transient, persistent)"
+    },
+    "rollbackPolicy": {
+      "type": "string",
+      "description": "Rollback strategy to use in case of failure"
+    },
+    "steps": {
+      "type": "array",
+      "items": {
+        "type": "object",
+        "required": ["id", "name", "action"],
+        "properties": {
+          "id": {
+            "type": "string"
+          },
+          "name": {
+            "type": "string"
+          },
+          "action": {
+            "type": "string"
+          },
+          "scopes": {
+            "type": "array",
+            "items": {
+              "type": "string"
+            }
+          }
+        },
+        "additionalProperties": false
+      },
+      "description": "Ordered list of steps to execute"
+    }
+  },
+  "additionalProperties": false
+}
*** Add File: scripts/validate_runbook.py
+#!/usr/bin/env python3
+import json
+import sys
+
+
+def validate_runbook(path: str) -> int:
+    """Validate a runbook JSON file against minimal schema requirements."""
+    try:
+        with open(path, "r", encoding="utf-8") as f:
+            data = json.load(f)
+    except Exception as e:
+        print(f"Failed to read runbook: {e}")
+        return 1
+
+    required_fields = ["schemaVersion", "runbookId", "scopes", "steps"]
+    missing = [f for f in required_fields if f not in data]
+    if missing:
+        print(f"Missing required fields: {', '.join(missing)}")
+        return 1
+
+    if not isinstance(data["steps"], list) or not data["steps"]:
+        print("The 'steps' field must be a non-empty array.")
+        return 1
+
+    print(f"Runbook '{data.get('runbookId')}' is valid.")
+    return 0
+
+
+def main() -> int:
+    if len(sys.argv) != 2:
+        print("Usage: validate_runbook.py <runbook.json>")
+        return 1
+    return validate_runbook(sys.argv[1])
+
+
+if __name__ == "__main__":
+    sys.exit(main())
*** Add File: ci/azure-devops/rollback-template.yml
+parameters:
+  environment: 'production'
+  rollback_steps:
+    - script: echo "Rolling back deployment"
+
+stages:
+  - stage: Rollback
+    jobs:
+      - job: Rollback
+        steps: ${{ parameters.rollback_steps }}
*** Add File: .github/workflows/rollback-example.yml
+name: Rollback
+on:
+  workflow_dispatch:
+    inputs:
+      environment:
+        description: 'Environment to roll back'
+        required: true
+        default: 'production'
+
+jobs:
+  rollback:
+    runs-on: ubuntu-latest
+    steps:
+      - name: Rollback
+        run: echo "Rolling back ${{ github.event.inputs.environment }}"
*** End Patch
